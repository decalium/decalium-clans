--- a/net/minecraft/world/entity/animal/horse/TraderLlama.java
+++ b/net/minecraft/world/entity/animal/horse/TraderLlama.java
@@ -20,25 +20,30 @@
 import net.minecraft.world.level.ServerLevelAccessor;
 
 public class TraderLlama extends Llama {
+
     private int despawnDelay = 47999;
 
     public TraderLlama(EntityType<? extends TraderLlama> type, Level world) {
         super(type, world);
     }
 
+    @Override
     public boolean isTraderLlama() {
         return true;
     }
 
+    @Override
     protected Llama makeBabyLlama() {
-        return EntityType.TRADER_LLAMA.create(this.level);
+        return (Llama) EntityType.TRADER_LLAMA.create(this.level);
     }
 
+    @Override
     public void addAdditionalSaveData(CompoundTag nbt) {
         super.addAdditionalSaveData(nbt);
         nbt.putInt("DespawnDelay", this.despawnDelay);
     }
 
+    @Override
     public void readAdditionalSaveData(CompoundTag nbt) {
         super.readAdditionalSaveData(nbt);
         if (nbt.contains("DespawnDelay", 99)) {
@@ -47,6 +52,7 @@
 
     }
 
+    @Override
     protected void registerGoals() {
         super.registerGoals();
         this.goalSelector.addGoal(1, new PanicGoal(this, 2.0D));
@@ -57,13 +63,16 @@
         this.despawnDelay = despawnDelay;
     }
 
+    @Override
     protected void doPlayerRide(Player player) {
         Entity entity = this.getLeashHolder();
+
         if (!(entity instanceof WanderingTrader)) {
             super.doPlayerRide(player);
         }
     }
 
+    @Override
     public void aiStep() {
         super.aiStep();
         if (!this.level.isClientSide) {
@@ -74,7 +83,7 @@
 
     private void maybeDespawn() {
         if (this.canDespawn()) {
-            this.despawnDelay = this.isLeashedToWanderingTrader() ? ((WanderingTrader)this.getLeashHolder()).getDespawnDelay() - 1 : this.despawnDelay - 1;
+            this.despawnDelay = this.isLeashedToWanderingTrader() ? ((WanderingTrader) this.getLeashHolder()).getDespawnDelay() - 1 : this.despawnDelay - 1;
             if (this.despawnDelay <= 0) {
                 this.dropLeash(true, false);
                 this.discard();
@@ -96,6 +105,7 @@
     }
 
     @Nullable
+    @Override
     public SpawnGroupData finalizeSpawn(ServerLevelAccessor world, DifficultyInstance difficulty, MobSpawnType spawnReason, @Nullable SpawnGroupData entityData, @Nullable CompoundTag entityNbt) {
         if (spawnReason == MobSpawnType.EVENT) {
             this.setAge(0);
@@ -105,10 +115,11 @@
             entityData = new AgeableMob.AgeableMobGroupData(false);
         }
 
-        return super.finalizeSpawn(world, difficulty, spawnReason, entityData, entityNbt);
+        return super.finalizeSpawn(world, difficulty, spawnReason, (SpawnGroupData) entityData, entityNbt);
     }
 
     protected static class TraderLlamaDefendWanderingTraderGoal extends TargetGoal {
+
         private final Llama llama;
         private LivingEntity ownerLastHurtBy;
         private int timestamp;
@@ -119,27 +130,33 @@
             this.setFlags(EnumSet.of(Goal.Flag.TARGET));
         }
 
+        @Override
         public boolean canUse() {
             if (!this.llama.isLeashed()) {
                 return false;
             } else {
                 Entity entity = this.llama.getLeashHolder();
+
                 if (!(entity instanceof WanderingTrader)) {
                     return false;
                 } else {
-                    WanderingTrader wanderingTrader = (WanderingTrader)entity;
-                    this.ownerLastHurtBy = wanderingTrader.getLastHurtByMob();
-                    int i = wanderingTrader.getLastHurtByMobTimestamp();
+                    WanderingTrader entityvillagertrader = (WanderingTrader) entity;
+
+                    this.ownerLastHurtBy = entityvillagertrader.getLastHurtByMob();
+                    int i = entityvillagertrader.getLastHurtByMobTimestamp();
+
                     return i != this.timestamp && this.canAttack(this.ownerLastHurtBy, TargetingConditions.DEFAULT);
                 }
             }
         }
 
+        @Override
         public void start() {
-            this.mob.setTarget(this.ownerLastHurtBy);
+            this.mob.setGoalTarget(this.ownerLastHurtBy, org.bukkit.event.entity.EntityTargetEvent.TargetReason.TARGET_ATTACKED_OWNER, true); // CraftBukkit
             Entity entity = this.llama.getLeashHolder();
+
             if (entity instanceof WanderingTrader) {
-                this.timestamp = ((WanderingTrader)entity).getLastHurtByMobTimestamp();
+                this.timestamp = ((WanderingTrader) entity).getLastHurtByMobTimestamp();
             }
 
             super.start();
